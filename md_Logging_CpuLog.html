<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CORC Project: Creating CPU utilization log from command line (LINUX)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CORC Project
   </div>
   <div id="projectbrief">CANOpen Robot Controller Software Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Creating CPU utilization log from command line (LINUX) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a guide for a basic CPU utilisation experiment for a CORC Application.</p>
<p>It takes output from the default Linux command <code>top</code> - sampling the current state of the system at regular intervals, and reduces the resulting output to only the CPU utilisation for the given application. This can then be post-processed to find an average across those intervals.</p>
<h2>Determine PID of EXO_APP_2020</h2>
<p><code>top</code> requires the Process Identification (PID) of the application under investigation. This can be found with the following command.</p>
<p><code>pidof EXO_APP_2020</code></p>
<p>We refer to the result of this as <code>&lt;PID&gt;</code>.</p>
<h2>Use of the top command</h2>
<p>We use the following options for the top command:</p>
<p>-p : only display top information for the specified PID process -b : batch mode (this formats the output such that it can be written to file) -d : Delay i.e. intervals between iterations</p>
<p>The suggested command format is as follows:</p>
<p><code>top -p &lt;PID&gt; -b -d 0.1 &gt; top.txt</code></p>
<p>This produces a file which logs the state of the machine at 1 second intervals. This interval can be changed by changing the <code>0.1</code> parameter.</p>
<p>This produces an output similar to that below (with the PID set to 2304):</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;top - 22:54:25 up  5:18,  3 users,  load average: 1.07, 0.71, 0.60</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Tasks:   1 total,   0 running,   1 sleeping,   0 stopped,   0 zombie</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;%Cpu(s):  0.5 us,  0.6 sy,  0.0 ni, 98.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;KiB Mem :   494876 total,   328284 free,    71448 used,    95144 buff/cache</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;KiB Swap:        0 total,        0 free,        0 used.   406028 avail Mem </div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; 2304 root      20   0   19572   1120   1016 S 18.8  0.2   0:11.43 EXO_APP_2020</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;top - 22:54:25 up  5:18,  3 users,  load average: 1.07, 0.71, 0.60</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Tasks:   1 total,   0 running,   1 sleeping,   0 stopped,   0 zombie</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;%Cpu(s): 50.0 us,  6.2 sy,  0.0 ni, 43.8 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;KiB Mem :   494876 total,   328284 free,    71448 used,    95144 buff/cache</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;KiB Swap:        0 total,        0 free,        0 used.   406028 avail Mem </div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; 2304 root      20   0   19572   1120   1016 S 27.3  0.2   0:11.46 EXO_APP_2020</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;top - 22:54:25 up  5:18,  3 users,  load average: 1.07, 0.71, 0.60</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;Tasks:   1 total,   0 running,   1 sleeping,   0 stopped,   0 zombie</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;%Cpu(s): 57.1 us,  0.0 sy,  0.0 ni, 42.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;KiB Mem :   494876 total,   328284 free,    71448 used,    95144 buff/cache</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;KiB Swap:        0 total,        0 free,        0 used.   406028 avail Mem </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; 2304 root      20   0   19572   1120   1016 S 20.0  0.2   0:11.48 EXO_APP_2020</div></div><!-- fragment --><h2>Sample only PID info lines to a file</h2>
<p>The following command removes all lines apart from the ones which include the PID. Note that it's possible that this also catches some 'incidental' (e.g. if your PID is 1, it will capture all lines with a 1 in it &mdash; this can optimised with a better command).</p>
<p><code>cat top.txt | grep &lt;PID&gt; &gt; topPIDonly.txt</code></p>
<p>This produces an output similar to below:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;2304 root      20   0   19572   1120   1016 S 18.8  0.2   0:11.43 EXO_APP_2020</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;2304 root      20   0   19572   1120   1016 S 27.3  0.2   0:11.46 EXO_APP_2020</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;2304 root      20   0   19572   1120   1016 S 20.0  0.2   0:11.48 EXO_APP_2020</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;2304 root      20   0   19572   1120   1016 S 18.2  0.2   0:11.50 EXO_APP_2020</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;2304 root      20   0   19572   1120   1016 S 20.0  0.2   0:11.52 EXO_APP_2020</div></div><!-- fragment --><h2>Display only CPU utilization from each line and pipe to file w/ nl for time period of each data point</h2>
<p>We can combine this with <code>cut -c (columns)</code> command to take only the relevant lines (those associated with CPU usage) - note that the relevant columns (48-52) have been manually specified.</p>
<p><code>cat top.txt | grep &lt;PID&gt; | cut -c 48-52| nl &gt;&gt; cpuLog.txt</code></p>
<p>(nl adds number line to each line entry - this is optional, and it may be easier to process if you do not use this line).</p>
<p>This produces an output similar to below, which can then be processed to calculate the average CPU utilisation.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;1   18.8 </div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;2   27.3 </div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;3   20.0 </div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;.</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
